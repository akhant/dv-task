(this["webpackJsonpdv-task"]=this["webpackJsonpdv-task"]||[]).push([[0],{117:function(e,t,n){"use strict";n.r(t);var a,r,c=n(1),i=n.n(c),o=n(13),d=n.n(o),u=n(20),s=n(58),l=n(32),f=n(21),p=n(26),j=n.n(p),b=n(52),v=n(53),m=function(e){var t,n=[],a=function t(n,a){var r=e.find((function(e){return e.id===n}));if(!(null===r||void 0===r?void 0:r.parts))return r.parentId=a,r;var c,i=[],o=Object(v.a)(r.parts);try{var d=function(){var n=c.value,r=Object(l.a)(Object(l.a)({},e.find((function(e){return e.id===n}))),{},{parentId:a.id});i.push(t(n,r))};for(o.s();!(c=o.n()).done;)d()}catch(u){o.e(u)}finally{o.f()}return a.childrens=i,a},r=Object(v.a)(e);try{for(r.s();!(t=r.n()).done;){var c=t.value;"main"!==c.id&&"production"!==c.id||n.push(a(c.id,c))}}catch(i){r.e(i)}finally{r.f()}return n},h=function(e){var t=[];return function e(n){var a,r=Object(v.a)(n);try{for(r.s();!(a=r.n()).done;){var c=a.value;c.childrens?e(c.childrens):t.push(c.id)}}catch(i){r.e(i)}finally{r.f()}}(e),t},O=n(30),x=n(93).a.initializeApp({apiKey:"AIzaSyD6DnGbVfdJlDJ_pEOUfDfTDJrA8j3lIs8",authDomain:"dv-inventory.firebaseapp.com",databaseURL:"https://dv-inventory.firebaseio.com",projectId:"dv-inventory",storageBucket:"dv-inventory.appspot.com",messagingSenderId:"130062240176",appId:"1:130062240176:web:ecbca5d29b37d25c6cee75"}),g=Object(O.b)("places/get",function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.firestore().collection("places").get();case 2:return n=e.sent,a=n.docs.map((function(e){return{id:e.id,data:{name:e.data().name},parts:e.data().parts&&e.data().parts.map((function(e){return e.id}))}})),e.abrupt("return",m(a));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y=Object(O.b)("inventory/get",function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.firestore().collection("inventory").get();case 2:return n=e.sent,a=n.docs.map((function(e){return{id:e.id,data:{name:e.data().name,count:e.data().count},placeId:e.data().place&&e.data().place.id}})),e.abrupt("return",{docs:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),I=Object(O.b)("inventory/add",function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.placeId,a=x.firestore(),e.next=4,a.collection("inventory").add({name:"",count:0,place:a.collection("places").doc(n)});case 4:return r=e.sent,e.abrupt("return",{invItem:{data:{name:"",count:0},id:r.id,placeId:n}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),w=Object(O.b)("inventory/update",function(){var e=Object(b.a)(j.a.mark((function e(t){var n,a,r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,a=t.name,r=t.count,c=t.placeId,e.next=3,x.firestore().collection("inventory").doc(n).set({name:a,count:r,place:x.firestore().collection("places").doc(c)});case 3:return e.abrupt("return",{invItem:{id:n,data:{name:a,count:r},placeId:c}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),k=Object(O.b)("inventory/remove",function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,x.firestore().collection("inventory").doc(n).delete(),e.abrupt("return",{id:n});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),S={inventory:[],places:[]},C=Object(O.c)({name:"places",initialState:S.places,reducers:{},extraReducers:(a={},Object(f.a)(a,g.fulfilled,(function(e,t){return t.payload})),Object(f.a)(a,g.rejected,(function(e,t){return[]})),a)}),N=Object(O.c)({name:"data",initialState:{placeId:"main",buildingId:"main"},reducers:{setPlaceId:function(e,t){return Object(l.a)(Object(l.a)({},e),{},{placeId:t.payload.placeId})},setBuildingId:function(e,t){return Object(l.a)(Object(l.a)({},e),{},{buildingId:t.payload.buildingId})}}}),B={inventory:Object(O.c)({name:"inventory",initialState:S.inventory,reducers:{},extraReducers:(r={},Object(f.a)(r,y.fulfilled,(function(e,t){return t.payload.docs})),Object(f.a)(r,y.rejected,(function(e,t){return e})),Object(f.a)(r,I.fulfilled,(function(e,t){return[].concat(Object(s.a)(e),[t.payload.invItem])})),Object(f.a)(r,I.rejected,(function(e,t){return e})),Object(f.a)(r,w.fulfilled,(function(e,t){var n=t.payload.invItem;return e.map((function(e){return e.id===n.id?Object(l.a)({},n):e}))})),Object(f.a)(r,w.rejected,(function(e,t){return e})),Object(f.a)(r,k.fulfilled,(function(e,t){return e.filter((function(e){return e.id!==t.payload.id}))})),Object(f.a)(r,k.rejected,(function(e,t){return e})),r)}).reducer,places:C.reducer,data:N.reducer},T=Object(O.a)({reducer:B,middleware:function(e){return e({thunk:!0,immutableCheck:!0,serializableCheck:!1})},devTools:!1}),z=N.actions,D=z.setPlaceId,E=z.setBuildingId,W=n(151),J=n(158),R=n(154),A=n(156),H=n(157),P=n(90),U=n.n(P),G=n(8),K=Object(W.a)((function(e){return{title:{fontSize:14},card:{cursor:"pointer",margin:10,display:"flex",alignItems:"center",transition:e.transitions.create(["transform","background"],{duration:500}),"&:hover":{transform:"translate(-3%,-3%)",background:"linear-gradient(0deg, #d1d1e0 30%, #e1e1ea 90%)"}},active:{background:"linear-gradient(0deg, #d1d1e0 30%, #e1e1ea 90%)"},iconStorageWrapper:{display:"flex",justifyContent:"center"}}})),L=function(e){var t,n,a=e.item,r=K(),c=Object(u.b)((function(e){return e})).inventory,i=Object(u.b)((function(e){return e})).data.placeId;return Object(G.jsx)(R.a,{className:"".concat(i===a.id?r.card+" "+r.active:r.card),onClick:function(e){T.dispatch(D({placeId:a.id}))},children:Object(G.jsxs)(A.a,{children:[Object(G.jsx)(H.a,{className:r.title,color:"textSecondary",gutterBottom:!0,children:a.data.name}),Object(G.jsx)("div",{className:r.iconStorageWrapper,children:(t=c,n=a.id,-1!==t.findIndex((function(e){return e.placeId===n}))&&Object(G.jsx)(U.a,{}))})]})})},V=Object(W.a)((function(e){return{root:{width:"100%",marginTop:40}}})),$=function(){var e=V(),t=Object(u.b)((function(e){return e})),n=t.places,a=t.data,r=n.find((function(e){return e.id===a.buildingId}));return Object(G.jsx)(J.a,{className:e.root,container:!0,children:function e(t){var n;return t?Object(G.jsxs)(J.a,{alignItems:"center",container:!0,direction:"column",children:[Object(G.jsx)(L,{item:t}),Object(G.jsx)(J.a,{justify:"center",wrap:"nowrap",container:!0,item:!0,direction:"row",xs:6,children:null===(n=t.childrens)||void 0===n?void 0:n.map((function(t){return e(t)}))})]},t.id):null}(r)})},_=n(51),q=n(166),F=n(159),M=n(167),Q=n(91),X=n.n(Q),Y=n(168),Z=n(163),ee=Object(W.a)((function(e){return{root:{},content:{display:"flex",justifyContent:"space-between",alignItems:"center",wordBreak:"break-all"},details:{display:"flex",justifyContent:"space-between"},heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},inputCount:{width:100,"& input":{textAlign:"center"}}}})),te=i.a.memo((function(e){var t,n,a=e.item,r=ee(),c=i.a.useState(!1),o=Object(_.a)(c,2),d=o[0],u=o[1],s=i.a.useState(null===(t=a.data)||void 0===t?void 0:t.name),l=Object(_.a)(s,2),f=l[0],p=l[1],j=i.a.useState(null===(n=a.data)||void 0===n?void 0:n.count),b=Object(_.a)(j,2),v=b[0],m=b[1];return Object(G.jsxs)(q.a,{expanded:d,onChange:function(){u((function(e){return!e}))},children:[Object(G.jsxs)(M.a,{"aria-controls":"panel1bh-content",id:"panel1bh-header",classes:{content:r.content},children:[Object(G.jsx)(H.a,{className:r.heading,children:a.data.name}),Object(G.jsx)(H.a,{className:r.secondaryHeading,children:a.data.count}),Object(G.jsx)(X.a,{onClick:function(e){e.stopPropagation(),T.dispatch(k({id:a.id}))}})]}),Object(G.jsxs)(F.a,{classes:{root:r.details},children:[Object(G.jsx)(Y.a,{value:f,onChange:function(e){return p(e.target.value)},label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",variant:"outlined"}),Object(G.jsx)(Y.a,{classes:{root:r.inputCount},value:v,onChange:function(e){return m(e.target.value)},label:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",variant:"outlined"}),Object(G.jsx)(Z.a,{variant:"outlined",onClick:function(){T.dispatch(w({id:a.id,name:f,count:Number(v),placeId:a.placeId}))},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})})),ne=Object(W.a)({root:{marginTop:40,width:"80%"}}),ae=i.a.memo((function(){Object(c.useEffect)((function(){T.dispatch(y())}),[]);var e=ne(),t=Object(u.b)((function(e){return e})),n=t.places,a=t.inventory,r=function(e,t,n){var a=[],r=function e(n){if(a=[].concat(Object(s.a)(a),Object(s.a)(t.filter((function(e){return e.placeId===n.id})))),n.childrens){var r,c=Object(v.a)(n.childrens);try{for(c.s();!(r=c.n()).done;)e(r.value)}catch(i){c.e(i)}finally{c.f()}}};return function e(t){var a,c=Object(v.a)(t);try{for(c.s();!(a=c.n()).done;){var i=a.value;if(i.id===n){r(i);break}i.childrens&&e(i.childrens)}}catch(o){c.e(o)}finally{c.f()}}(e),a}(n,a,t.data.placeId);return Object(G.jsx)("div",{className:e.root,children:a.length?r.map((function(e){return Object(G.jsx)(te,{item:e},e.id)})):null})})),re=n(164),ce=n(170),ie=n(171),oe=n(162),de=n(165),ue=Object(W.a)((function(e){return{formControl:{width:300,marginTop:40,marginBottom:40}}})),se=function(){var e=ue(),t=Object(u.b)((function(e){return e})).places,n=Object(c.useState)("\u0413\u043b\u0430\u0432\u043d\u044b\u0439 \u043e\u0444\u0438\u0441"),a=Object(_.a)(n,2),r=a[0],i=a[1];return Object(G.jsxs)(oe.a,{variant:"outlined",className:e.formControl,children:[Object(G.jsx)(ce.a,{id:"demo-simple-select-label",children:"\u0417\u0434\u0430\u043d\u0438\u0435"}),Object(G.jsx)(de.a,{labelId:"building-select",id:"building-select",value:r,onChange:function(e){T.dispatch(E({buildingId:e.nativeEvent.target.dataset.id})),T.dispatch(D({placeId:e.nativeEvent.target.dataset.id})),i(e.target.value)},label:"\u0417\u0434\u0430\u043d\u0438\u0435",children:null===t||void 0===t?void 0:t.map((function(e){if("main"===e.id||"production"===e.id)return Object(G.jsx)(ie.a,{"data-id":e.id,value:e.data.name,children:e.data.name},e.id)}))})]})},le=n(92),fe=n.n(le),pe=Object(W.a)((function(e){return{root:{minHeight:"100vh"},divider:{alignSelf:"stretch"},addIcon:{cursor:"pointer",color:"#43d691",fontSize:50,transition:e.transitions.create(["transform"],{duration:500}),"&:hover":{color:"#2ed185",transform:"scale(1.1)"}},addIconWrapper:{display:"flex",justifyContent:"end",marginTop:20,width:"80%"}}}));var je=function(){var e=pe(),t=Object(u.b)((function(e){return e})),n=t.places,a=t.data;return Object(c.useEffect)((function(){T.dispatch(g())}),[]),Object(G.jsx)("div",{className:e.root,children:Object(G.jsxs)(J.a,{className:e.root,container:!0,direction:"row",children:[Object(G.jsxs)(J.a,{container:!0,direction:"column",alignItems:"center",item:!0,xs:6,children:[Object(G.jsx)(se,{}),Object(G.jsx)(re.a,{className:e.divider,variant:"middle"}),Object(G.jsx)($,{})]}),Object(G.jsx)(J.a,{item:!0,xs:1,children:Object(G.jsx)(re.a,{orientation:"vertical"})}),Object(G.jsxs)(J.a,{item:!0,xs:5,children:[Object(G.jsx)(ae,{}),h(n).some((function(e){return e===a.placeId}))&&Object(G.jsx)("div",{className:e.addIconWrapper,children:Object(G.jsx)(fe.a,{className:e.addIcon,onClick:function(){T.dispatch(I({placeId:T.getState().data.placeId}))}})})]})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));d.a.render(Object(G.jsx)(u.a,{store:T,children:Object(G.jsx)(je,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[117,1,2]]]);
//# sourceMappingURL=main.9fd222a6.chunk.js.map